<!doctype html>
<html lang="pt-br">

<head>
  <title>Página de Cadastro</title>
  <link rel="icon" type="image/x-icon" href="../../logotipo.png">
  <!-- Meta tags importantes para responsividade e codificação -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <!-- Bootstrap CSS para estilos prontos e responsivos -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-iYQeCzEYFbKjA/T2uDLTpkwGzCiq6soy8tYaI1GyVh/UjpbCx/TYkiZhlZB6+fzT" crossorigin="anonymous">
  <link rel="stylesheet" href="../CSS/cadastro.css">
</head>

<body>
  <!-- Uma camada de overlay para efeito visual de fundo (ex: escurecer fundo) -->
  <div class="overlay"></div>

  <header>
    <!-- Espaço reservado para a barra de navegação, se houver -->
  </header>

  <div class="container-cadastro">
  
  <!-- Logo central da página -->
  <img src="../IMG/shellselect.png" alt="Logo Shell" class="logo-central">

  <main>
    <!-- Formulário de cadastro, com envio para o script PHP que processará os dados -->
    <form action="../PHP/cadastro.php" method="post" class="wrapper-cadastro container">
      <!-- Logo no topo do formulário -->
      <img src="../IMG/shell.png" alt="Logo Shell" class="logo-topo">
      <h1>Cadastro</h1>
      
      <!-- Campo oculto para identificar que este formulário é o de cadastro -->
      <input type="hidden" name="cadastro_form" value="1">
    
      <div class="row">
        <!-- Coluna 1 com campos nome, data de nascimento e CPF -->
        <div class="col-md-6">
          <div class="mb-3">
            <label for="nome" class="form-label">Nome completo:</label>
            <input type="text" class="form-control" id="nome" name="nome" required>
          </div>
    
          <div class="mb-3">
            <label for="data" class="form-label">Data de Nascimento:</label>
            <input type="date" class="form-control" id="data" name="data" required>
          </div>
    
          <div class="mb-3">
            <label for="cpf" class="form-label">CPF:</label>
            <!-- Campo de texto para CPF com máscara aplicada via JavaScript -->
            <input type="text" class="form-control" id="cpf" name="cpf" required oninput="maskCpf(this)">
          </div>
        </div>
    
        <!-- Coluna 2 com campos email, senha e confirmação de senha -->
        <div class="col-md-6">
          <div class="mb-3">
            <label for="email" class="form-label">E-mail:</label>
            <input type="email" class="form-control" id="email" name="email" placeholder="Ex: Nathally@gmail.com" required>
          </div>
    
          <div class="mb-3">
            <label for="senha" class="form-label">Senha:</label>
            <!-- Validação da senha via pattern (mínimo 6 caracteres, uma maiúscula, um número e um caractere especial) -->
            <input type="password" class="form-control" id="senha" name="senha" required pattern="(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*]).{6,}">
            <div class="form-text">A senha deve conter pelo menos 6 caracteres, uma letra maiúscula, um número e um caractere especial.</div>
          </div>
    
          <div class="mb-3">
            <label for="con_senha" class="form-label">Confirmar senha:</label>
            <input type="password" class="form-control" id="con_senha" name="con_senha" required>
          </div>
        </div>
      </div>
    
      <!-- Botão para enviar o formulário -->
      <button type="submit" class="btn-primary">Cadastrar</button>
    </form>
    
  </div>
  </main>

  <footer>
    <!-- Espaço para rodapé, se necessário -->
  </footer>

  <!-- Bootstrap JavaScript Libraries para componentes interativos -->
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"
    integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3" crossorigin="anonymous">
    </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/js/bootstrap.min.js"
    integrity="sha384-7VPbUDkoPSGFnVtYi0QogXtr74QeVeeIs99Qfg5YCF+TidwNdjvaKZX19NZ/e6oz" crossorigin="anonymous">
    </script>

  <script>
    // Evento para aplicar máscara no campo CPF ao digitar
    document.getElementById("cpf").addEventListener("input", function (e) {
      // Remove tudo que não é número
      let value = e.target.value.replace(/\D/g, "");

      // Limita o tamanho máximo a 11 dígitos (CPF tem 11 números)
      if (value.length > 11) {
        value = value.slice(0, 11);
      }

      // Aplica máscara no formato 000.000.000-00
      value = value.replace(/(\d{3})(\d)/, "$1.$2");
      value = value.replace(/(\d{3})(\d)/, "$1.$2");
      value = value.replace(/(\d{3})(\d{1,2})$/, "$1-$2");

      // Atualiza o valor do campo com a máscara
      e.target.value = value;
    });

    // Validação customizada na submissão do formulário para checar se o usuário tem pelo menos 18 anos
    document.querySelector("form").addEventListener("submit", function (e) {
      const dataNascimento = document.getElementById("data").value;
      const hoje = new Date();
      const nascimento = new Date(dataNascimento);

      // Calcula a idade baseada no ano, mês e dia
      const idade = hoje.getFullYear() - nascimento.getFullYear();
      const m = hoje.getMonth() - nascimento.getMonth();
      const dia = hoje.getDate() - nascimento.getDate();

      // Se menor que 18 anos, impede envio do formulário e mostra alerta
      if (idade < 18 || (idade === 18 && (m < 0 || (m === 0 && dia < 0)))) {
        e.preventDefault();
        alert("Você deve ter pelo menos 18 anos para se cadastrar.");
      }
    });
  </script>
</body>

</html>
